<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Something Sus</title>
<style>
  .shape {
    width: 100px;
    height: 100px;
    display: inline-block;
    margin: 10px;
  }
  /* Colors will be set dynamically */
</style>
<script>
  let round = 1;
  let impostorRevealed = false;
  let totalShapes = 4;
  let impostorIndex; // Declare impostorIndex globally

  function startRound() {
    impostorRevealed = false;
    totalShapes = 4 * round;
    const gameArea = document.getElementById('gameArea');
    gameArea.innerHTML = '';
    changeColors(); // Call changeColors to set new colors for the round

    for (let i = 0; i < totalShapes; i++) {
      const shape = document.createElement('div');
      shape.classList.add('shape');
      shape.onclick = function() { shapeClicked(i === impostorIndex); };
      gameArea.appendChild(shape);
    }

    impostorIndex = Math.floor(Math.random() * totalShapes);
    gameArea.children[impostorIndex].classList.add('different');
    setTimeout(revealImpostor, 5000);
  }

  function shapeClicked(isImpostor) {
    if (!impostorRevealed) {
      if (isImpostor) {
        impostorRevealed = true;
        gameArea.children[impostorIndex].style.backgroundColor = 'red';
        setTimeout(startRound, 2000); // Wait 2 seconds, then start new round
      } else {
        alert("That's not the impostor, you lose!");
        round = 1;
        startRound();
      }
    }
  }

  function revealImpostor() {
    if (!impostorRevealed) {
      impostorRevealed = true;
      const impostor = document.querySelector('.different');
      impostor.style.backgroundColor = 'red';
      setTimeout(startRound, 2000); // Wait 2 seconds, then start new round
    }
  }

  function changeColors() {
    // Generate random colors for shapes and background
    const newColor = '#' + Math.floor(Math.random()*16777215).toString(16);
    const backgroundColor = '#' + Math.floor(Math.random()*16777215).toString(16);
    document.body.style.backgroundColor = backgroundColor;
    const shapes = document.getElementsByClassName('shape');
    for (let shape of shapes) {
      shape.style.backgroundColor = newColor;
    }
    // Set a different color for the impostor
    const impostorColor = '#' + Math.floor(Math.random()*16777215).toString(16);
    if (shapes[impostorIndex]) {
      shapes[impostorIndex].style.backgroundColor = impostorColor;
    }
  }

  window.onload = startRound;
</script>
</head>
<body>
  <div id="gameArea">
    <!-- Shapes will be generated here -->
  </div>
</body>
</html>
